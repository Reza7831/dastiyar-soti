import speech_recognition as sr
import pyautogui as pack
import screen_brightness_control as sbc


wakeUpCall = "Ø³ÛŒØ³ØªÙ…"


exit_commands = ['Ø®Ø±ÙˆØ¬', 'Ø®Ø±ÙˆØ¬', 'Ø®Ø§Ø±Ø¬', 'ØªÙ…Ø§Ù…', 'ØªÙ…ÙˆÙ…', 'Ù¾Ø§ÛŒØ§Ù†']

prev_commands = ['Ù‚Ø¨Ù„ÛŒ', 'Ù‚Ø¨Ù„ÛŒÙ‡']
next_commands = ['Ø¨Ø¹Ø¯ÛŒ', 'Ø¨Ø¹Ø¯ÛŒÙ‡']

play_commands = ['Ù¾Ù„ÛŒ', 'Ù¾Ø®Ø´']
stop_commands = ['Ø§Ø³ØªØ§Ù¾', 'Ø§Ø³ØªÙˆÙ¾', 'Ù‚Ø·Ø¹', 'Ù…ØªÙˆÙ‚Ù', 'Ø¨Ø¨Ù†Ø¯']

sound_commands = ['ØµØ¯Ø§', 'Ø¢Ù‡Ù†Ú¯', 'Ø§Ù‡Ù†Ú¯', 'Ù…ÙˆØ³ÛŒÙ‚ÛŒ']
sound_mute_commands = ['Ø¨Ø¨Ù†Ø¯', 'Ù…ÛŒÙˆØª']
sound_vol_down = ['Ú©Ù…', 'Ù¾Ø§ÛŒÛŒÙ†']
sound_vol_up = ['Ø¨Ø§Ù„Ø§', 'Ø²ÛŒØ§Ø¯']

bright_commands = ['Ù†ÙˆØ±']
bright_up_commands = ['Ø²ÛŒØ§Ø¯', 'Ø¨Ø§Ù„Ø§']
bright_down_commands = ['Ú©Ù…', 'Ù¾Ø§ÛŒÛŒÙ†']

def voiceRec():
    r = sr.Recognizer()
    mic = sr.Microphone(device_index=1)
    while True:
        try:
            with mic as src:
                audio = r.listen(src)
                command = r.recognize_google(audio, language='fa-IR').lower()
                if wakeUpCall in command:
                    if any(item in command for item in exit_commands):
                        print('Ø¯Ø± Ø­Ø§Ù„ Ø®Ø±ÙˆØ¬')
                        break
                    elif any(item in command for item in prev_commands):
                        pack.press('prevtrack')
                        print ('Ø§Ù†Ø¬Ø§Ù… Ø¯Ø§Ø¯Ù…')
                    elif any(item in command for item in next_commands):
                        pack.press('nexttrack')
                        print('Ø§Ù†Ø¬Ø§Ù… Ø¯Ø§Ø¯Ù…')
                    elif any(item in command for item in play_commands):
                        pack.press('playpause')
                        print('Ø§Ù†Ø¬Ø§Ù… Ø¯Ø§Ø¯Ù…')
                    elif any(item in command for item in stop_commands):
                        pack.press('playpause')
                        print('Ø§Ù†Ø¬Ø§Ù… Ø¯Ø§Ø¯Ù…')
                    elif any(item in command for item in sound_commands):
                        if any(item in command for item in sound_mute_commands):
                            pack.press('valumemute')
                            print("muteing")
                        elif any(item in command for item in sound_vol_down):
                            pack.press('valumedown', presses=5)
                            print("lowring the volume")
                        elif any(item in command for item in sound_vol_up):
                            pack.press('valumeup', presses=5)
                            print("increasing the volume")
                    elif any(item in command for item in bright_commands):
                        if any(item in command for item in bright_up_commands):
                            sbc.set_brightness(90)
                    elif any(item in command for item in bright_down_commands):
                            sbc.set_brightness(30)
                    else:
                        print('Ù…ØªÙˆØ¬Ù‡ Ù†Ø´Ø¯Ù… ğŸ˜')
        except Exception as e:
            print(e)
            r = sr.Recognizer()
            continue


voiceRec()
